Настройка MikroTik RouterOS для интернет-провайдера с 5000 абонентов

1. Обработка трафика с использованием Connection Tracking

Используйте Connection Tracking для отслеживания состояния соединений (Established, Related, Invalid). Это повышает безопасность и эффективность маршрутизации.

Правила для цепочек INPUT и FORWARD:

/ip/firewall/filter add chain=input action=accept connection-state=established,related log=no
/ip/firewall/filter add chain=input action=drop connection-state=invalid log=no
/ip/firewall/filter add chain=forward action=accept connection-state=established,related log=no
/ip/firewall/filter add chain=forward action=drop connection-state=invalid log=no

2. Ограничение ICMP-трафика

Разрешите ICMP-трафик с ограничением по количеству пакетов в секунду, чтобы избежать злоупотреблений (например, ICMP-флуд).

Пример правила:

/ip/firewall/filter add chain=input action=accept protocol=icmp in-interface-list=<WAN_Interface> limit=50/5s,2:packet log=no

3. Дополнительные рекомендации для масштабируемости

Ограничение скорости (Rate Limiting): Настройте ограничение скорости на интерфейсах или для отдельных абонентов.

Очереди (Queues): Используйте очереди для управления пропускной способностью.

Фильтрация по MAC-адресам: Настройте фильтрацию по MAC-адресам для предотвращения спуфинга.

Логирование: Включите логирование для критически важных правил.


4. Оптимизация для большого числа абонентов

FastTrack: Включите FastTrack для ускорения обработки трафика.

/ip/firewall/filter add chain=forward action=fasttrack-connection connection-state=established,related

Увеличение размера таблицы соединений: Увеличьте размер таблицы соединений.

/ip/firewall/connection/tracking set enabled=yes table-size=65536


5. Безопасность

Защита от DDoS: Настройте правила для защиты от DDoS-атак.

Фильтрация по гео-IP: Используйте списки IP-адресов для блокировки трафика из подозрительных регионов.


6. Мониторинг и управление

SNMP: Настройте SNMP для мониторинга состояния маршрутизатора.

Удаленное управление: Ограничьте доступ к управлению маршрутизатором только с доверенных IP-адресов.


